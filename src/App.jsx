import React,{useState,useEffect,useRef,useMemo}from'react';import{Save,Trash2,Plus,Search,Activity,Copy,Check,Settings,LogOut,X,Filter,Tag,Upload,Download,FileUp,Pencil,Star,Moon,Sun}from'lucide-react';
const COLOR_PRESETS=['#0A1A2F','#009FB8','#6D28D9','#BE123C','#059669','#C2410C','#475569'];const getGradientStyle=h=>h?{background:`linear-gradient(135deg,${h},${h}dd)`}:{};const normalizeTenant=t=>(t&&typeof t==='string'?t.trim():'')||'default';
export default function App(){const[tenant,setTenant]=useState(()=>normalizeTenant(localStorage.getItem('tenant'))),[shortcuts,setShortcuts]=useState([]),[labelColors,setLabelColors]=useState({}),[loading,setLoading]=useState(true),[formData,setFormData]=useState({id:null,name:'',url:'',icon_url:'',parent_label:'',parent_color:COLOR_PRESETS[0],child_label:'',child_color:COLOR_PRESETS[1]}),[searchTerm,setSearchTerm]=useState(''),[showFilterPanel,setShowFilterPanel]=useState(false),[activeParentFilter,setActiveParentFilter]=useState(null),[activeChildFilter,setActiveChildFilter]=useState(null),[copiedId,setCopiedId]=useState(null),[userRole,setUserRole]=useState(()=>localStorage.getItem('userRole')||'guest'),[showLoginModal,setShowLoginModal]=useState(false),[showAddModal,setShowAddModal]=useState(false),[loginCreds,setLoginCreds]=useState({username:'',password:''}),[loginError,setLoginError]=useState(''),[sortMode,setSortMode]=useState('default'),[showFavoritesOnly,setShowFavoritesOnly]=useState(false),[dark,setDark]=useState(()=>localStorage.getItem('darkMode')==='true'),fileInputRef=useRef(null),importInputRef=useRef(null);
const isAdmin=userRole==='admin'||userRole==='superadmin',isSuperAdmin=userRole==='superadmin';
const fetchData=async(t)=>{setLoading(true);try{const r=await fetch('/api/data?tenant='+encodeURIComponent(t));const d=await r.json();if(!r.ok)throw new Error(d.error);setShortcuts(d.shortcuts||[]);setLabelColors(d.labelColors||{})}catch(e){console.error(e)}finally{setLoading(false)}};
useEffect(()=>{fetchData(tenant)},[tenant]);
const resetForm=()=>setFormData({id:null,name:'',url:'',icon_url:'',parent_label:'',parent_color:COLOR_PRESETS[0],child_label:'',child_color:COLOR_PRESETS[1]});
const handleSubmit=async(e)=>{e.preventDefault();if(!formData.name.trim()||!formData.url.trim())return alert('Thiếu tên/URL');try{const p={...formData,name:formData.name.trim(),url:formData.url.trim(),tenant};const r=await fetch(formData.id?`/api/shortcuts/${formData.id}`:'/api/shortcuts',{method:formData.id?'PUT':'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(p)});if(!r.ok)throw new Error((await r.json()).error);await fetchData(tenant);resetForm();setShowAddModal(false)}catch(e){alert(e.message)}};
const handleDelete=async(id)=>{if(!window.confirm('Xóa?'))return;try{if((await fetch(`/api/shortcuts/${id}`,{method:'DELETE'})).ok)await fetchData(tenant)}catch(e){alert(e.message)}};
const handleEdit=(i,e)=>{e.stopPropagation();setFormData({id:i.id,name:i.name,url:i.url,icon_url:i.icon_256||i.icon_url||'',parent_label:i.parent_label||'',parent_color:labelColors[i.parent_label]||COLOR_PRESETS[0],child_label:i.child_label||'',child_color:labelColors[i.child_label]||COLOR_PRESETS[1]});setShowAddModal(true)};
const handleLinkClick=(id,u)=>{fetch(`/api/click/${id}`,{method:'POST'}).catch(()=>{});setShortcuts(p=>p.map(s=>s.id===id?{...s,clicks:(s.clicks||0)+1}:s));window.open(u,'_blank','noopener,noreferrer')};
const handleFavoriteToggle=async(id,e)=>{e.stopPropagation();try{const r=await fetch(`/api/favorite/${id}`,{method:'POST'});if(r.ok)setShortcuts(p=>p.map(s=>s.id===id?{...s,favorite:(await r.json()).favorite}:s))}catch(e){alert(e.message)}};
const handleExportData=()=>{const d={version:2,timestamp:new Date().toISOString(),tenant,shortcuts:shortcuts.map(({id,...r})=>r),labels:Object.entries(labelColors).map(([n,c])=>({name:n,color_class:c,tenant}))};const a=document.createElement('a');a.href='data:text/json;charset=utf-8,'+encodeURIComponent(JSON.stringify(d));a.download=`backup_${tenant}.json`;document.body.appendChild(a);a.click();a.remove()};
const handleImportData=(e)=>{const f=e.target.files?.[0];if(!f)return;const r=new FileReader();r.onload=async(ev)=>{try{const i=JSON.parse(ev.target.result);if(!i.tenant)i.tenant=tenant;if((await fetch('/api/import',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(i)})).ok){alert('Thành công!');await fetchData(tenant)}}catch(x){alert(x.message)}finally{e.target.value=null}};r.readAsText(f)};
const handleImageUpload=(e)=>{const f=e.target.files?.[0];if(!f)return;const r=new FileReader();r.onload=(ev)=>{const i=new Image();i.onload=()=>{const c=document.createElement('canvas'),ctx=c.getContext('2d'),s=Math.max(256/i.width,256/i.height);c.width=256;c.height=256;ctx.drawImage(i,(256-i.width*s)/2,(256-i.height*s)/2,i.width*s,i.height*s);setFormData(p=>({...p,icon_url:c.toDataURL('image/png')}))};i.src=ev.target.result};r.readAsDataURL(f)};
const copyToClipboard=(t,id)=>{if(!navigator.clipboard)return;navigator.clipboard.writeText(t);setCopiedId(id);setTimeout(()=>setCopiedId(null),2000)};
const handleLogin=async(e)=>{e.preventDefault();try{const r=await fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(loginCreds)});const d=await r.json();if(!r.ok)throw new Error(d.error);setUserRole(d.role);localStorage.setItem('userRole',d.role);setShowLoginModal(false)}catch(err){setLoginError(err.message)}};
const uniqueParents=useMemo(()=>[...new Set(shortcuts.map(s=>s.parent_label).filter(Boolean))].sort(),[shortcuts]);
const uniqueChildren=useMemo(()=>[...new Set(shortcuts.map(s=>s.child_label).filter(Boolean))].sort(),[shortcuts]);
const filteredShortcuts=useMemo(()=>{const t=searchTerm.trim().toLowerCase();let l=shortcuts.filter(i=>(!t||i.name.toLowerCase().includes(t)||i.url.toLowerCase().includes(t))&&(!activeParentFilter||i.parent_label===activeParentFilter)&&(!activeChildFilter||i.child_label===activeChildFilter)&&(!showFavoritesOnly||i.favorite===1));return l.sort((a,b)=>{if((b.favorite||0)!==(a.favorite||0))return(b.favorite||0)-(a.favorite||0);if(sortMode==='alpha')return a.name.localeCompare(b.name);if(sortMode==='parent')return(a.parent_label||'').localeCompare(b.parent_label||'');return 0})},[shortcuts,searchTerm,activeParentFilter,activeChildFilter,sortMode,showFavoritesOnly]);
const toggleDark=()=>{setDark(p=>{const n=!p;localStorage.setItem('darkMode',String(n));return n})};
if(loading)return<div className={'min-h-screen flex items-center justify-center '+(dark?'bg-slate-900 text-slate-100':'bg-[#F4F4F4] text-[#5A5A5A]')}><div className="flex flex-col items-center gap-2"><Activity className="w-8 h-8 animate-spin mx-auto mb-1"/><p className="text-sm">Loading...</p></div></div>;
return(
<div className={(dark?'dark ':'')+'min-h-screen font-sans '+(dark?'bg-slate-900 text-slate-100':'bg-[#F4F4F4] text-[#2C2C2C]')}>
<div className="sticky top-0 z-30 w-full flex flex-col items-center pt-4 px-4 pointer-events-none gap-2">
<div className="flex items-center gap-2 pointer-events-auto w-full max-w-2xl">
<div className="flex flex-1 gap-2"><div className="relative w-32"><input type="text" className={'w-full px-3 py-2 rounded-full text-xs border '+(dark?'bg-slate-800 border-slate-700 text-slate-100':'bg-white border-[#D8D8D8] text-[#2C2C2C]')} value={tenant} onChange={e=>{const v=normalizeTenant(e.target.value);setTenant(v);localStorage.setItem('tenant',v)}} placeholder="Tenant"/><span className="absolute -bottom-4 left-2 text-[10px] text-gray-400">multi-tenant</span></div>
<div className="relative group flex-1"><Search className="absolute inset-y-0 left-0 pl-3 h-full w-7 text-[#A0A0A0]"/><input type="text" className={'block w-full pl-10 pr-3 py-2 border-none rounded-full text-sm shadow-sm backdrop-blur-sm transition-all '+(dark?'bg-slate-800 text-slate-100 focus:ring-2 focus:ring-sky-500':'bg-[#D8D8D8]/40 text-[#2C2C2C] focus:bg-white focus:ring-2 focus:ring-[#009FB8]/50')} placeholder="Search..." value={searchTerm} onChange={e=>setSearchTerm(e.target.value)}/></div></div>
<div className="flex items-center gap-1"><select value={sortMode} onChange={e=>setSortMode(e.target.value)} className={'text-xs rounded-full px-2 py-1 border '+(dark?'bg-slate-800 border-slate-700 text-slate-100':'bg-white border-[#D8D8D8] text-[#5A5A5A]')}><option value="default">Default</option><option value="alpha">A-Z</option><option value="parent">Group</option></select>
<button onClick={()=>setShowFavoritesOnly(v=>!v)} className={'p-2 rounded-full shadow-sm border flex items-center '+(showFavoritesOnly?'bg-amber-400 text-white border-amber-500':dark?'bg-slate-800 text-slate-300 border-slate-700':'bg-white text-[#A0A0A0] border-[#D8D8D8]')}><Star className="w-4 h-4"/></button>
<button onClick={()=>setShowFilterPanel(v=>!v)} className={'p-2 rounded-full shadow-sm border '+(showFilterPanel||activeParentFilter||activeChildFilter?'bg-[#009FB8] text-white border-[#009FB8]':dark?'bg-slate-800 text-slate-300 border-slate-700':'bg-white text-[#A0A0A0] border-[#D8D8D8]')}><Filter size={18}/></button>
<button onClick={toggleDark} className={'p-2 rounded-full shadow-sm border '+(dark?'bg-slate-800 text-yellow-300 border-slate-700':'bg-white text-slate-600 border-[#D8D8D8]')}>{dark?<Sun size={16}/>:<Moon size={16}/>}</button></div></div>
{(showFilterPanel||activeParentFilter||activeChildFilter)&&(<div className={'pointer-events-auto w-full max-w-2xl rounded-2xl p-3 shadow-lg flex flex-col gap-3 border '+(dark?'bg-slate-800/90 border-slate-700 text-slate-100':'bg-white/80 border-[#D8D8D8]')}><div className="flex flex-wrap items-center gap-2"><span className="text-xs font-bold text-[#A0A0A0] uppercase">Group:</span><button onClick={()=>setActiveParentFilter(null)} className={'px-3 py-1 text-xs rounded-full border transition-all '+(!activeParentFilter?(dark?'bg-slate-900 text-slate-100 border-slate-600':'bg-[#0A1A2F] text-white border-transparent'):(dark?'bg-transparent text-slate-200 border-slate-600':'bg-transparent text-[#5A5A5A] border-[#D8D8D8]'))}>All</button>{uniqueParents.map(l=><button key={l} onClick={()=>setActiveParentFilter(activeParentFilter===l?null:l)} className={'px-3 py-1 text-xs rounded-full border flex items-center gap-1 transition-all '+(activeParentFilter===l?'text-white border-transparent ring-2 ring-[#009FB8]':(dark?'bg-slate-900 text-slate-100 border-slate-700':'bg-white text-[#5A5A5A] border-[#D8D8D8]'))} style={activeParentFilter===l?{background:labelColors[l]}:{}}>{l}</button>)}</div>{uniqueChildren.length>0&&(<div className="flex flex-wrap items-center gap-2 border-t border-[#D8D8D8]/60 pt-2"><span className="text-xs font-bold text-[#A0A0A0] uppercase">Tag:</span>{uniqueChildren.map(l=><button key={l} onClick={()=>setActiveChildFilter(activeChildFilter===l?null:l)} className={'px-2 py-0.5 text-[10px] rounded-md border flex items-center gap-1 transition-all '+(activeChildFilter===l?'bg-[#009FB8] text-white border-[#009FB8]':(dark?'bg-slate-700 text-slate-100 border-slate-600':'bg-[#F4F4F4] text-[#5A5A5A] border-[#D8D8D8]'))} style={activeChildFilter===l&&labelColors[l]?{background:labelColors[l],color:'white',borderColor:labelColors[l]}:{}}><Tag size={10}/>{l}</button>)}</div>)}</div>)}
<div className="fixed top-0 right-0 p-4 z-40 pointer-events-auto opacity-0 hover:opacity-100 transition-opacity duration-300">{isAdmin?(<div className={'flex flex-col gap-2 rounded-2xl border shadow-lg p-2 backdrop-blur-md '+(dark?'bg-slate-800/80 border-slate-700 text-slate-100':'bg-white/50 border-white/20 text-[#2C2C2C]')}><div className="flex items-center justify-between px-1"><span className="text-[10px] uppercase font-bold opacity-70">{isSuperAdmin?'Superadmin':'Admin'} ({tenant})</span></div><div className="flex gap-2"><button onClick={()=>{resetForm();setShowAddModal(true)}} className={'p-2 rounded-full hover:scale-110 transition-transform '+(dark?'bg-slate-900 text-slate-100':'bg-[#0F2F55] text-white')}><Plus size={18}/></button><button onClick={handleExportData} className={'p-2 rounded-full hover:scale-110 transition-transform border '+(dark?'bg-slate-900 text-slate-100 border-slate-700':'bg-white text-[#0A1A2F] border-[#D6E4F5]')}><Download size={18}/></button><button onClick={()=>importInputRef.current?.click()} className={'p-2 rounded-full hover:scale-110 transition-transform border '+(dark?'bg-slate-900 text-slate-100 border-slate-700':'bg-white text-[#009FB8] border-[#D6E4F5]')}><FileUp size={18}/></button><input type="file" ref={importInputRef} className="hidden" accept=".json" onChange={handleImportData}/></div><button onClick={handleLogout} className={'p-2 w-full rounded-xl text-xs font-bold flex items-center justify-center gap-1 '+(dark?'bg-rose-900/40 text-rose-300':'bg-[#BE123C]/10 text-[#BE123C]')}><LogOut size={14}/> LOGOUT</button></div>):(<button onClick={()=>setShowLoginModal(true)} className={'p-2 rounded-full shadow-lg border hover:scale-105 transition-transform '+(dark?'bg-slate-800 text-slate-200 border-slate-700':'bg-white text-[#A0A0A0] border-[#D8D8D8]')}><Settings size={20}/></button>)}</div>
</div>
<div className="max-w-7xl mx-auto px-6 pb-20 pt-6"><div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-x-8 gap-y-10 justify-items-center">
{filteredShortcuts.map(i=><div key={i.id} className="group relative flex flex-col items-center w-28 cursor-pointer active:scale-95 transition-transform" onClick={()=>handleLinkClick(i.id,i.url)}>
<div className="absolute -top-2 -right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity z-10 scale-90"><button onClick={e=>{e.stopPropagation();copyToClipboard(i.url,i.id)}} className={'p-1.5 rounded-full shadow-sm border '+(dark?'bg-slate-900 text-slate-100 border-slate-700':'bg-white text-[#A0A0A0] border-[#D8D8D8]')}>{copiedId===i.id?<Check size={12} className="text-[#009FB8]"/>:<Copy size={12}/>}</button>{isAdmin&&(<><button onClick={e=>handleEdit(i,e)} className={'p-1.5 rounded-full shadow-sm border ml-1 '+(dark?'bg-slate-900 text-slate-100 border-slate-700':'bg-white text-[#A0A0A0] border-[#D8D8D8]')}><Pencil size={12}/></button><button onClick={e=>{e.stopPropagation();handleDelete(i.id)}} className={'p-1.5 rounded-full shadow-sm border ml-1 '+(dark?'bg-slate-900 text-slate-100 border-slate-700':'bg-white text-[#A0A0A0] border-[#D8D8D8]')}><Trash2 size={12}/></button></>)}</div>
<button onClick={e=>handleFavoriteToggle(i.id,e)} className={'absolute -top-3 -left-3 rounded-full p-1 shadow '+(i.favorite?'bg-amber-400 text-white':(dark?'bg-slate-800 text-slate-300':'bg-white text-slate-400'))}><Star className="w-3 h-3"/></button>
<div className="w-20 h-20 rounded-[1.4rem] flex items-center justify-center text-white text-3xl font-bold shadow-md hover:shadow-lg transition-all mb-2 overflow-hidden relative" style={getGradientStyle(labelColors[i.parent_label]||'#0A1A2F')}>{i.icon_128||i.icon_256||i.icon_url?<img src={i.icon_128||i.icon_256||i.icon_url} alt={i.name} className="w-full h-full object-cover"/>:<span>{i.name.charAt(0).toUpperCase()}</span>}</div>
<span className="text-sm font-medium text-center truncate w-32 px-1 group-hover:opacity-90">{i.name}</span><div className="flex flex-wrap justify-center gap-1 mt-1 px-1">{i.parent_label&&<span className="text-[9px] px-1.5 py-0.5 rounded-full text-white truncate max-w-[70px]" style={{background:labelColors[i.parent_label]||'#9CA3AF'}}>{i.parent_label}</span>}{i.child_label&&<span className={'text-[9px] px-1.5 py-0.5 rounded-full border truncate max-w-[70px] '+(dark?'border-slate-600 text-slate-200':'border-[#D8D8D8] text-[#5A5A5A]')} style={{borderColor:labelColors[i.child_label]||'#E5E7EB'}}>{i.child_label}</span>}</div></div>)}
{isAdmin&&(<div className="flex flex-col items-center w-28 cursor-pointer group" onClick={()=>{resetForm();setShowAddModal(true)}}><div className={'w-20 h-20 rounded-[1.4rem] border-2 border-dashed flex items-center justify-center transition-all mb-3 '+(dark?'bg-slate-800/60 border-slate-600 text-slate-400 group-hover:text-slate-100':'bg-[#D8D8D8]/40 border-[#A0A0A0] text-[#A0A0A0] group-hover:text-[#0F2F55]')}><Plus size={32}/></div><span className={'text-sm font-medium '+(dark?'text-slate-400 group-hover:text-slate-100':'text-[#A0A0A0] group-hover:text-[#0F2F55]')}>Thêm App</span></div>)}
</div></div>
{showLoginModal&&(<div className="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-4"><div className={'rounded-2xl shadow-2xl w-full max-w-xs p-6 border '+(dark?'bg-slate-900 border-slate-700 text-slate-100':'bg-white border-[#D8D8D8] text-[#2C2C2C]')}><div className="flex justify-between items-center mb-6"><h3 className="font-bold text-base">Admin Login</h3><button onClick={()=>setShowLoginModal(false)}><X size={20}/></button></div><form onSubmit={handleLogin} className="space-y-4"><input type="text" placeholder="Username" className={'w-full px-4 py-2 rounded-lg text-sm '+(dark?'bg-slate-800 text-slate-100 border border-slate-700':'bg-[#F4F4F4] border border-transparent')} value={loginCreds.username} onChange={e=>setLoginCreds(p=>({...p,username:e.target.value}))}/><input type="password" placeholder="Password" className={'w-full px-4 py-2 rounded-lg text-sm '+(dark?'bg-slate-800 text-slate-100 border border-slate-700':'bg-[#F4F4F4] border border-transparent')} value={loginCreds.password} onChange={e=>setLoginCreds(p=>({...p,password:e.target.value}))}/>{loginError&&<p className="text-red-500 text-xs">{loginError}</p>}<button className={'w-full py-2 rounded-lg text-sm font-semibold '+(dark?'bg-sky-600 text-white hover:bg-sky-500':'bg-[#0F2F55] text-white')}>Login</button></form></div></div>)}
{showAddModal&&(<div className="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-4"><div className={'rounded-2xl shadow-2xl w-full max-w-md p-6 max-h-[90vh] overflow-y-auto '+(dark?'bg-slate-900 text-slate-100 border border-slate-700':'bg-white text-[#2C2C2C] border border-[#D8D8D8]')}><div className="flex justify-between items-center mb-4"><h3 className="font-bold text-base">{formData.id?'Sửa Ứng Dụng':'Thêm Ứng Dụng'}</h3><button onClick={()=>setShowAddModal(false)}><X size={20}/></button></div><form onSubmit={handleSubmit} className="space-y-3"><input type="text" placeholder="Tên App" className={'w-full px-4 py-3 rounded-xl text-sm '+(dark?'bg-slate-800 border border-slate-700 text-slate-100':'bg-[#F4F4F4] border border-transparent')} value={formData.name} onChange={e=>setFormData(p=>({...p,name:e.target.value}))} required/><input type="url" placeholder="URL" className={'w-full px-4 py-3 rounded-xl text-sm '+(dark?'bg-slate-800 border border-slate-700 text-slate-100':'bg-[#F4F4F4] border border-transparent')} value={formData.url} onChange={e=>setFormData(p=>({...p,url:e.target.value}))} required/><div onClick={()=>fileInputRef.current?.click()} className={'w-full px-4 py-3 rounded-xl cursor-pointer flex items-center gap-2 '+(dark?'bg-slate-800':'bg-[#F4F4F4]')}>{formData.icon_url?<img src={formData.icon_url} className="w-8 h-8 rounded" alt="icon"/>:<Upload size={20}/>}<span className="text-sm opacity-70">Upload Icon</span></div><input type="file" ref={fileInputRef} className="hidden" accept="image/*" onChange={handleImageUpload}/><div className="border-t border-[#D8D8D8]/60 pt-3 space-y-4"><h4 className="text-xs font-bold text-[#A0A0A0] uppercase">Phân loại & Màu sắc</h4><div><div className="flex items-center gap-2 mb-2"><input type="text" placeholder="Nhóm lớn (VD: Work)" className={'flex-1 px-3 py-2 rounded-lg text-sm border '+(dark?'bg-slate-800 border-slate-700 text-slate-100':'bg-[#F4F4F4] border-[#D8D8D8]')} value={formData.parent_label} onChange={e=>setFormData(p=>({...p,parent_label:e.target.value}))}/></div><div className="flex gap-2 items-center">{COLOR_PRESETS.map(c=><div key={c} onClick={()=>setFormData(p=>({...p,parent_color:c}))} className={'w-6 h-6 rounded-full cursor-pointer border border-gray-300 '+(formData.parent_color===c?'ring-2 ring-black':'')} style={{background:c}}/>)}<div className="relative w-6 h-6 rounded-full overflow-hidden border border-gray-300"><input type="color" className="absolute -top-2 -left-2 w-10 h-10 cursor-pointer" value={formData.parent_color} onChange={e=>setFormData(p=>({...p,parent_color:e.target.value}))}/></div></div></div><div><div className="flex items-center gap-2 mb-2"><Tag size={14} className="text-[#A0A0A0]"/><input type="text" placeholder="Nhóm con (VD: Dev)" className={'flex-1 px-3 py-2 rounded-lg text-sm border '+(dark?'bg-slate-800 border-slate-700 text-slate-100':'bg-[#F4F4F4] border-[#D8D8D8]')} value={formData.child_label} onChange={e=>setFormData(p=>({...p,child_label:e.target.value}))}/></div><div className="flex gap-2 items-center opacity-80">{COLOR_PRESETS.map(c=><div key={c+'_child'} onClick={()=>setFormData(p=>({...p,child_color:c}))} className={'w-5 h-5 rounded-full cursor-pointer border border-gray-300 '+(formData.child_color===c?'ring-2 ring-black':'')} style={{background:c}}/>)}<div className="relative w-5 h-5 rounded-full overflow-hidden border border-gray-300"><input type="color" className="absolute -top-2 -left-2 w-10 h-10 cursor-pointer" value={formData.child_color} onChange={e=>setFormData(p=>({...p,child_color:e.target.value}))}/></div></div></div></div><button className={'w-full py-3 rounded-xl text-sm font-semibold mt-2 '+(dark?'bg-sky-600 text-white hover:bg-sky-500':'bg-[#0F2F55] text-white')}>Lưu</button></form></div></div>)}
</div>
);}
